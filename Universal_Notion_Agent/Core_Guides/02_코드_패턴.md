# ğŸ’» Notion í˜ì´ì§€ ì‘ì„± ì½”ë“œ íŒ¨í„´ (ë²”ìš©)

> ğŸ’¡ **ë²”ìš© ê°€ì´ë“œ**: ëª¨ë“  MCP ì§€ì› AI í”Œë«í¼ì—ì„œ ì‚¬ìš© ê°€ëŠ¥

## ğŸ“‹ TL;DR (í•µì‹¬ ìš”ì•½)

**ëª©ì **: ì‹¤í–‰ ê°€ì´ë“œì—ì„œ ì‚¬ìš©í•  ì½”ë“œ íŒ¨í„´ ë° í•¨ìˆ˜ ì œê³µ

**ì£¼ìš” í•¨ìˆ˜**:

1. `formatPageTitle()` - ì œëª© í¬ë§·íŒ…
2. `splitIntoChunks()` - ì²­í¬ ë¶„í• 
3. `copyToClipboard()` - í´ë¦½ë³´ë“œ ë³µì‚¬
4. `scrollAndFocus()` - ìŠ¤í¬ë¡¤ ë° í¬ì»¤ìŠ¤
5. `verifyContent()` - ë‚´ìš© ê²€ì¦
6. `parseParentPageId()` - ë¶€ëª¨ í˜ì´ì§€ URL/ID íŒŒì‹±
7. `resolveFilePath()` - íŒŒì¼ ê²½ë¡œ í•´ì„

---

## ğŸ¯ ì œëª© í¬ë§·íŒ… í•¨ìˆ˜

**Input**: íŒŒì¼ëª… (string)  
**Output**: í¬ë§·íŒ…ëœ ì œëª© (string)

**ê·œì¹™**:

1. íŒŒì¼ëª…ì—ì„œ `.md` í™•ì¥ì ì œê±°
2. `_` â†’ ê³µë°± ë³€í™˜
3. ì—°ì† ê³µë°± â†’ ë‹¨ì¼ ê³µë°±
4. ì•ë’¤ ê³µë°± ì œê±°

### JavaScript ë²„ì „

```javascript
// íŒŒì¼ëª…ì—ì„œ í™•ì¥ì ì œê±° ë° ì œëª© í¬ë§·íŒ…
function formatPageTitle(fileName) {
  // 1. í™•ì¥ì ì œê±°
  let pageTitle = fileName.replace(/\.md$/, "");

  // 2. ì–¸ë”ìŠ¤ì½”ì–´ë¥¼ ê³µë°±ìœ¼ë¡œ ë³€í™˜
  pageTitle = pageTitle.replace(/_/g, " ");

  // 3. ì—°ì†ëœ ê³µë°± ì œê±° ë° ì•ë’¤ ê³µë°± ì œê±°
  pageTitle = pageTitle.replace(/\s+/g, " ").trim();

  return pageTitle;
}

// ì‚¬ìš© ì˜ˆì‹œ
const fileName = "ë…¸ì…˜_ì…‹ì—…_ê°€ì´ë“œ.md";
const pageTitle = formatPageTitle(fileName);
// ê²°ê³¼: "ë…¸ì…˜ ì…‹ì—… ê°€ì´ë“œ"
```

### Python ë²„ì „

```python
import re

def format_page_title(file_name):
    # 1. í™•ì¥ì ì œê±°
    page_title = file_name.replace('.md', '') if file_name.endswith('.md') else file_name

    # 2. ì–¸ë”ìŠ¤ì½”ì–´ë¥¼ ê³µë°±ìœ¼ë¡œ ë³€í™˜
    page_title = page_title.replace('_', ' ')

    # 3. ì—°ì†ëœ ê³µë°± ì œê±° ë° ì•ë’¤ ê³µë°± ì œê±°
    page_title = re.sub(r'\s+', ' ', page_title).strip()

    return page_title

# ì‚¬ìš© ì˜ˆì‹œ
file_name = "ë…¸ì…˜_ì…‹ì—…_ê°€ì´ë“œ.md"
page_title = format_page_title(file_name)
# ê²°ê³¼: "ë…¸ì…˜ ì…‹ì—… ê°€ì´ë“œ"
```

---

## âœ‚ï¸ ì²­í¬ ë¶„í•  í•¨ìˆ˜

**Input**: íŒŒì¼ ë‚´ìš© (string), ë¼ì¸ ìˆ˜ (number)  
**Output**: ì²­í¬ ë°°ì—´ (string[])

**ê·œì¹™**:

- < 500ì¤„: 1ê°œ ì²­í¬
- 500-2,000ì¤„: 200-300ì¤„ ë‹¨ìœ„
- > 2,000ì¤„: 300-500ì¤„ ë‹¨ìœ„
- ê° ì²­í¬ëŠ” ìµœëŒ€ 2,000ì

### JavaScript ë²„ì „

```javascript
function splitIntoChunks(content, lineCount) {
  const lines = content.split("\n");
  const chunks = [];

  let chunkSize;
  if (lineCount < 500) {
    chunkSize = lineCount; // 1ê°œ ì²­í¬
  } else if (lineCount <= 2000) {
    chunkSize = 250; // 200-300ì¤„ ë‹¨ìœ„
  } else {
    chunkSize = 400; // 300-500ì¤„ ë‹¨ìœ„
  }

  for (let i = 0; i < lines.length; i += chunkSize) {
    const chunk = lines.slice(i, i + chunkSize).join("\n");

    // 2,000ì ì œí•œ í™•ì¸
    if (chunk.length > 2000) {
      // ë” ì‘ì€ ì²­í¬ë¡œ ë¶„í• 
      const subChunks = chunk.match(/.{1,2000}/g) || [];
      chunks.push(...subChunks);
    } else {
      chunks.push(chunk);
    }
  }

  return chunks;
}
```

---

## ğŸ“‹ í´ë¦½ë³´ë“œ ë³µì‚¬ í•¨ìˆ˜

**Input**: í…ìŠ¤íŠ¸ (string, ìµœëŒ€ 2,000ì)  
**Output**: ì„±ê³µ ì—¬ë¶€ (boolean), ì—ëŸ¬ ë©”ì‹œì§€ (ì„ íƒì , string)

**ë¸Œë¼ìš°ì € ë„êµ¬**: `browser_evaluate`

### JavaScript íŒ¨í„´ (browser_evaluateì—ì„œ ì‚¬ìš©)

```javascript
// browser_evaluateì—ì„œ ì‚¬ìš©í•  íŒ¨í„´
async () => {
  const text = `[ì²­í¬ ë‚´ìš©]`; // ìµœëŒ€ 2,000ì

  try {
    await navigator.clipboard.writeText(text);
    return {
      success: true,
      message: "í´ë¦½ë³´ë“œì— ë³µì‚¬ ì™„ë£Œ",
      chunkSize: text.length,
    };
  } catch (err) {
    return {
      success: false,
      error: err.message,
    };
  }
};
```

**ì¬ì‹œë„ ë¡œì§** (ìµœëŒ€ 3íšŒ):

```javascript
async function copyToClipboardWithRetry(text, maxRetries = 3) {
  for (let i = 0; i < maxRetries; i++) {
    try {
      await navigator.clipboard.writeText(text);
      return { success: true };
    } catch (err) {
      if (i === maxRetries - 1) {
        return { success: false, error: err.message };
      }
      await new Promise((resolve) => setTimeout(resolve, 1000));
    }
  }
}
```

---

## ğŸ“œ í˜ì´ì§€ í•˜ë‹¨ ìŠ¤í¬ë¡¤ ë° í¬ì»¤ìŠ¤

**ë¸Œë¼ìš°ì € ë„êµ¬**: `browser_evaluate`

### JavaScript íŒ¨í„´

```javascript
// browser_evaluateì—ì„œ ì‚¬ìš©í•  íŒ¨í„´
() => {
  // 1. í˜ì´ì§€ í•˜ë‹¨ìœ¼ë¡œ ìŠ¤í¬ë¡¤
  window.scrollTo(0, document.body.scrollHeight);

  // 2. í¸ì§‘ ì˜ì—­ ì°¾ê¸° ë° í¬ì»¤ìŠ¤
  const textbox = document.querySelector('textbox[aria-label*="ì…ë ¥"]');
  if (textbox) {
    textbox.focus();
    textbox.click();
    return { success: true };
  }

  return { success: false, error: "í¸ì§‘ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤" };
};
```

---

## ğŸ” ë‚´ìš© ê²€ì¦ í•¨ìˆ˜

**Input**: íŒŒì¼ì˜ ë§ˆì§€ë§‰ ì¤„ í…ìŠ¤íŠ¸ (string)  
**Output**: ê²€ì¦ ê²°ê³¼ (boolean)

**ë¸Œë¼ìš°ì € ë„êµ¬**: `browser_evaluate`

### JavaScript íŒ¨í„´

```javascript
// browser_evaluateì—ì„œ ì‚¬ìš©í•  íŒ¨í„´
(lastLine) => {
  const pageText = document.body.innerText;
  const hasLastLine = pageText.includes(lastLine);

  return {
    success: hasLastLine,
    pageLength: pageText.length,
    hasLastLine: hasLastLine,
  };
};
```

---

## âœ… ì œëª© ì…ë ¥ ê²€ì¦ í•¨ìˆ˜

**ëª©ì **: ì œëª©ì´ ì •í™•íˆ ì…ë ¥ë˜ì—ˆëŠ”ì§€ í™•ì¸

**Input**: ì˜ˆìƒ ì œëª© (string)  
**Output**: ê²€ì¦ ê²°ê³¼ (object)

**ë¸Œë¼ìš°ì € ë„êµ¬**: `browser_evaluate`

### JavaScript íŒ¨í„´

```javascript
// ì œëª© ì…ë ¥ ê²€ì¦
function verifyTitleInput(expectedTitle) {
  return browser_evaluate((expected) => {
    const titleElement = document.querySelector('h1[contenteditable="true"]');
    const actualTitle = titleElement?.innerText.trim();
    
    // ì œëª© ì¼ì¹˜ ì—¬ë¶€ í™•ì¸
    if (actualTitle !== expected) {
      return {
        success: false,
        error: "ERR_TITLE_MISMATCH",
        expected: expected,
        actual: actualTitle,
        message: "ì œëª©ì´ ì •í™•íˆ ì…ë ¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤"
      };
    }
    
    // ëª…ë ¹ì–´ í¬í•¨ ì—¬ë¶€ í™•ì¸
    if (actualTitle.includes('/page') || actualTitle.includes('Ctrl+')) {
      return {
        success: false,
        error: "ERR_TITLE_HAS_COMMAND",
        actual: actualTitle,
        message: "ì œëª©ì— ëª…ë ¹ì–´ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤"
      };
    }
    
    return { 
      success: true, 
      title: actualTitle,
      message: "ì œëª© ì…ë ¥ ê²€ì¦ ì™„ë£Œ"
    };
  }, expectedTitle);
}
```

---

## ğŸ¯ ë‚´ìš© ì˜ì—­ ì´ë™ í™•ì¸ í•¨ìˆ˜

**ëª©ì **: ì œëª© ì˜ì—­ì—ì„œ ì™„ì „íˆ ë²—ì–´ë‚˜ ë‚´ìš© ì˜ì—­ìœ¼ë¡œ ì´ë™

**Output**: ì´ë™ ê²°ê³¼ (object)

**ë¸Œë¼ìš°ì € ë„êµ¬**: `browser_evaluate`

### JavaScript íŒ¨í„´

```javascript
// ë‚´ìš© ì˜ì—­ìœ¼ë¡œ ì•ˆì „í•˜ê²Œ ì´ë™
function moveToContentArea() {
  return browser_evaluate(() => {
    // 1. ì œëª© ì˜ì—­ í™•ì¸
    const titleElement = document.querySelector('h1[contenteditable="true"]');
    const isFocusedOnTitle = titleElement?.contains(document.activeElement);
    
    if (isFocusedOnTitle) {
      // ì œëª© ì˜ì—­ì—ì„œ ë²—ì–´ë‚˜ê¸°
      const bodyElement = document.querySelector('[contenteditable="true"]:not(h1)');
      if (bodyElement) {
        bodyElement.focus();
        bodyElement.click();
      } else {
        return {
          success: false,
          error: "ë‚´ìš© ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
        };
      }
    }
    
    // 2. ë‚´ìš© ì˜ì—­ í™•ì¸
    const contentArea = document.querySelector('[contenteditable="true"]:not(h1)');
    if (!contentArea) {
      return {
        success: false,
        error: "ë‚´ìš© ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
      };
    }
    
    // 3. ìµœí•˜ë‹¨ìœ¼ë¡œ ì´ë™
    contentArea.focus();
    const range = document.createRange();
    range.selectNodeContents(contentArea);
    range.collapse(false); // ëìœ¼ë¡œ
    
    const selection = window.getSelection();
    selection.removeAllRanges();
    selection.addRange(range);
    
    return {
      success: true,
      isTitleArea: false,
      message: "ë‚´ìš© ì˜ì—­ìœ¼ë¡œ ì´ë™ ì™„ë£Œ"
    };
  });
}
```

---

## ğŸ”’ ì²­í¬ ì…ë ¥ ì „ ê²€ì¦ í•¨ìˆ˜ (ì œëª© ë³´í˜¸)

**ëª©ì **: ì²­í¬ ì…ë ¥ ì „ ì œëª© ì˜ì—­ ë³´í˜¸ ë° ìœ„ì¹˜ í™•ì¸

**Input**: ì˜ˆìƒ ì œëª© (string)  
**Output**: ê²€ì¦ ê²°ê³¼ (object)

**ë¸Œë¼ìš°ì € ë„êµ¬**: `browser_evaluate`

### JavaScript íŒ¨í„´

```javascript
// ì²­í¬ ì…ë ¥ ì „ ê²€ì¦
function preChunkUploadCheck(expectedTitle) {
  return browser_evaluate((expected) => {
    const titleElement = document.querySelector('h1[contenteditable="true"]');
    const currentTitle = titleElement?.innerText.trim();
    const isFocusedOnTitle = titleElement?.contains(document.activeElement);
    
    // 1. ì œëª© ì˜ì—­ì— í¬ì»¤ìŠ¤ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
    if (isFocusedOnTitle) {
      return {
        success: false,
        error: "ERR_FOCUSED_ON_TITLE",
        message: "ì œëª© ì˜ì—­ì— í¬ì»¤ìŠ¤ë¨ - ë‚´ìš© ì˜ì—­ìœ¼ë¡œ ì´ë™ í•„ìš”"
      };
    }
    
    // 2. ì œëª©ì´ ë³€ê²½ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸
    if (currentTitle !== expected) {
      return {
        success: false,
        error: "ERR_TITLE_CHANGED",
        expected: expected,
        actual: currentTitle,
        message: "ì œëª©ì´ ë³€ê²½ë¨ - ì¤‘ë‹¨ í•„ìš”"
      };
    }
    
    return { 
      success: true,
      message: "ì…ë ¥ ì „ ê²€ì¦ ì™„ë£Œ"
    };
  }, expectedTitle);
}
```

---

## ğŸ” ì²­í¬ ì…ë ¥ í›„ ê²€ì¦ í•¨ìˆ˜ (ì œëª© + ì—°ê²°ì„±)

**ëª©ì **: ì²­í¬ ì…ë ¥ í›„ ì œëª© ë³´í˜¸ ë° ì´ì „ ì²­í¬ì™€ ì—°ê²°ì„± í™•ì¸

**Input**: 
- ì˜ˆìƒ ì œëª© (string)
- ì´ì „ ì²­í¬ ë§ˆì§€ë§‰ ë¶€ë¶„ (string, ì„ íƒì )
- í˜„ì¬ ì²­í¬ ì‹œì‘ ë¶€ë¶„ (string, ì„ íƒì )

**Output**: ê²€ì¦ ê²°ê³¼ (object)

**ë¸Œë¼ìš°ì € ë„êµ¬**: `browser_evaluate`

### JavaScript íŒ¨í„´

#### 1. ì œëª© ë³€ê²½ í™•ì¸

```javascript
// ì²­í¬ ì…ë ¥ í›„: ì œëª© í™•ì¸
function postChunkUploadTitleCheck(expectedTitle) {
  return browser_evaluate((expected) => {
    const titleElement = document.querySelector('h1[contenteditable="true"]');
    const currentTitle = titleElement?.innerText.trim();
    
    if (currentTitle !== expected) {
      return {
        success: false,
        error: "ERR_TITLE_CORRUPTED",
        expected: expected,
        actual: currentTitle,
        message: "ì œëª©ì´ ë³€ê²½ë¨ - ë³µêµ¬ í•„ìš”"
      };
    }
    
    return { 
      success: true, 
      title: currentTitle,
      message: "ì œëª© ë³´í˜¸ í™•ì¸ ì™„ë£Œ"
    };
  }, expectedTitle);
}
```

#### 2. ì²­í¬ ì—°ê²°ì„± í™•ì¸ (2ë²ˆì§¸ ì²­í¬ë¶€í„°)

```javascript
// ì²­í¬ ì…ë ¥ í›„: ì´ì „ ì²­í¬ì™€ ì—°ê²°ì„± í™•ì¸
function verifyChunkContinuity(previousChunkEnd, currentChunkStart) {
  return browser_evaluate((prevEnd, currStart) => {
    const bodyText = document.body.innerText;
    
    // 1. ì´ì „ ì²­í¬ì˜ ë§ˆì§€ë§‰ ë¶€ë¶„ì´ ìˆëŠ”ì§€ í™•ì¸
    const hasPreviousEnd = bodyText.includes(prevEnd);
    
    // 2. í˜„ì¬ ì²­í¬ì˜ ì‹œì‘ ë¶€ë¶„ì´ ìˆëŠ”ì§€ í™•ì¸
    const hasCurrentStart = bodyText.includes(currStart);
    
    // 3. ìˆœì„œê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸ (ì´ì „ ë â†’ í˜„ì¬ ì‹œì‘)
    const previousEndIndex = bodyText.indexOf(prevEnd);
    const currentStartIndex = bodyText.indexOf(currStart);
    const isCorrectOrder = previousEndIndex !== -1 && 
                           currentStartIndex !== -1 && 
                           previousEndIndex < currentStartIndex;
    
    if (!hasPreviousEnd || !hasCurrentStart) {
      return {
        success: false,
        error: "ERR_CHUNK_MISSING",
        hasPreviousEnd: hasPreviousEnd,
        hasCurrentStart: hasCurrentStart,
        message: "ì²­í¬ê°€ ëˆ„ë½ë¨"
      };
    }
    
    if (!isCorrectOrder) {
      return {
        success: false,
        error: "ERR_CHUNK_ORDER",
        previousEndIndex: previousEndIndex,
        currentStartIndex: currentStartIndex,
        message: "ì²­í¬ ìˆœì„œê°€ ì˜ëª»ë¨"
      };
    }
    
    return { 
      success: true,
      message: "ì²­í¬ ì—°ê²°ì„± í™•ì¸ ì™„ë£Œ",
      previousEndIndex: previousEndIndex,
      currentStartIndex: currentStartIndex,
      distance: currentStartIndex - previousEndIndex
    };
  }, previousChunkEnd, currentChunkStart);
}
```

#### 3. í†µí•© ê²€ì¦ í•¨ìˆ˜

```javascript
// ì²­í¬ ì—…ë¡œë“œ í†µí•© ê²€ì¦ (ì œëª© + ì—°ê²°ì„±)
async function postChunkUploadVerification(
  expectedTitle, 
  previousChunkEnd = null, 
  currentChunkStart = null
) {
  // 1. ì œëª© í™•ì¸
  const titleCheck = await postChunkUploadTitleCheck(expectedTitle);
  if (!titleCheck.success) {
    return titleCheck;
  }
  
  // 2. ì—°ê²°ì„± í™•ì¸ (2ë²ˆì§¸ ì²­í¬ë¶€í„°)
  if (previousChunkEnd && currentChunkStart) {
    const continuityCheck = await verifyChunkContinuity(
      previousChunkEnd, 
      currentChunkStart
    );
    if (!continuityCheck.success) {
      return continuityCheck;
    }
    
    return {
      success: true,
      titleCheck: titleCheck,
      continuityCheck: continuityCheck,
      message: "ì „ì²´ ê²€ì¦ ì™„ë£Œ"
    };
  }
  
  // ì²« ë²ˆì§¸ ì²­í¬ëŠ” ì œëª©ë§Œ í™•ì¸
  return titleCheck;
}
```

### ì‚¬ìš© ì˜ˆì‹œ

```javascript
// ì²­í¬ ì—…ë¡œë“œ ì˜ˆì‹œ
const chunks = ["ì²­í¬1", "ì²­í¬2", "ì²­í¬3"];
const expectedTitle = "ë¬¸ì„œ ì œëª©";

for (let i = 0; i < chunks.length; i++) {
  // ì…ë ¥ ì „ ê²€ì¦
  const preCheck = await preChunkUploadCheck(expectedTitle);
  if (!preCheck.success) {
    throw new Error(preCheck.error);
  }
  
  // ì²­í¬ ì…ë ¥
  await uploadChunk(chunks[i]);
  
  // ì…ë ¥ í›„ ê²€ì¦
  let postCheck;
  if (i === 0) {
    // ì²« ë²ˆì§¸ ì²­í¬: ì œëª©ë§Œ í™•ì¸
    postCheck = await postChunkUploadTitleCheck(expectedTitle);
  } else {
    // 2ë²ˆì§¸ ì´í›„: ì œëª© + ì—°ê²°ì„± í™•ì¸
    const prevEnd = chunks[i - 1].slice(-50);
    const currStart = chunks[i].slice(0, 50);
    postCheck = await postChunkUploadVerification(
      expectedTitle,
      prevEnd,
      currStart
    );
  }
  
  if (!postCheck.success) {
    throw new Error(postCheck.error);
  }
  
  console.log(`ì²­í¬ ${i + 1}/${chunks.length} ì—…ë¡œë“œ ë° ê²€ì¦ ì™„ë£Œ`);
}
```

---

## ğŸ”— ë¶€ëª¨ í˜ì´ì§€ URL íŒŒì‹± í•¨ìˆ˜

**Input**: URL ë˜ëŠ” UUID (string)  
**Output**: í˜ì´ì§€ ID (string, í•˜ì´í”ˆ ì—†ìŒ)

**ì§€ì› í˜•ì‹**:

- `https://www.notion.so/2939168184838094b94bc4ad6aab8c88`
- `https://purple-paint-fa5.notion.site/...`
- `29391681-8483-8094-b94b-c4ad6aab8c88`

### JavaScript ë²„ì „

```javascript
function parseParentPageId(input) {
  // 1. URL í˜•ì‹ì¸ì§€ í™•ì¸
  if (input.startsWith("http")) {
    try {
      const url = new URL(input);
      const pathParts = url.pathname.split("/").filter((p) => p);

      // ë§ˆì§€ë§‰ ê²½ë¡œ ë¶€ë¶„ì´ í˜ì´ì§€ ID
      let pageId = pathParts[pathParts.length - 1];

      // ì•µì»¤ ì œê±°
      pageId = pageId.split("#")[0];

      // í•˜ì´í”ˆ ì œê±°
      pageId = pageId.replace(/-/g, "");

      return pageId;
    } catch (e) {
      throw new Error(`URL íŒŒì‹± ì‹¤íŒ¨: ${input}`);
    }
  }

  // 2. UUID í˜•ì‹ì¸ ê²½ìš° (í•˜ì´í”ˆ ì œê±°)
  return input.replace(/-/g, "");
}
```

---

## ğŸ” ë¶€ëª¨ í˜ì´ì§€ í•˜ìœ„ ìƒì„± ê²€ì¦ í•¨ìˆ˜

**ëª©ì **: APIë¡œ ìƒì„±í•œ í˜ì´ì§€ê°€ ì‹¤ì œë¡œ ë¶€ëª¨ í˜ì´ì§€ í•˜ìœ„ì— ìˆëŠ”ì§€ í™•ì¸

**Input**: 
- ë¶€ëª¨ í˜ì´ì§€ URL (string)
- ì˜ˆìƒ í˜ì´ì§€ ì œëª© (string)

**Output**: ê²€ì¦ ê²°ê³¼ (object)

**ë¸Œë¼ìš°ì € ë„êµ¬**: `browser_navigate`, `browser_run_code`

### JavaScript íŒ¨í„´

```javascript
// API ì„±ê³µ í›„ ì‹¤ì œ ìœ„ì¹˜ ê²€ì¦
async function verifyPageUnderParent(parentPageUrl, expectedTitle) {
  // 1. ë¶€ëª¨ í˜ì´ì§€ ì ‘ì†
  await browser_navigate({ url: parentPageUrl });
  await browser_wait_for({ time: 2 });
  
  // 2. ì‚¬ì´ë“œë°”ì—ì„œ í•˜ìœ„ í˜ì´ì§€ í™•ì¸
  const result = await browser_run_code({
    code: `async (page) => {
      return await page.evaluate((title) => {
        const treeItems = Array.from(document.querySelectorAll('[role="treeitem"]'));
        
        // í˜„ì¬ í˜ì´ì§€ (ë¶€ëª¨) ì°¾ê¸°
        let currentPageItem = null;
        for (const item of treeItems) {
          const isExpanded = item.getAttribute('aria-expanded') === 'true';
          const isCurrent = item.querySelector('[aria-current="page"]') !== null;
          
          if ((isExpanded || isCurrent) && item.querySelector('[role="group"]')) {
            currentPageItem = item;
            break;
          }
        }
        
        if (!currentPageItem) {
          return { 
            success: false, 
            error: "ë¶€ëª¨ í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",
            hasParentPage: false
          };
        }
        
        // ë¶€ëª¨ í˜ì´ì§€ í•˜ìœ„ ê·¸ë£¹ í™•ì¸
        const parentGroup = currentPageItem.querySelector('[role="group"]');
        
        if (!parentGroup) {
          return { 
            success: false, 
            error: "ë¶€ëª¨ í˜ì´ì§€ì— í•˜ìœ„ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤",
            hasParentPage: true,
            hasChildren: false
          };
        }
        
        // í•˜ìœ„ í˜ì´ì§€ ëª©ë¡ í™•ì¸
        const childItems = Array.from(parentGroup.querySelectorAll('[role="treeitem"]'));
        
        // ëª©í‘œ í˜ì´ì§€ê°€ í•˜ìœ„ì— ìˆëŠ”ì§€ í™•ì¸
        const hasTargetPage = childItems.some(item => {
          const text = item.textContent.trim();
          return text.includes(title) || 
                 text === 'ìƒˆ í˜ì´ì§€' || 
                 text === 'Untitled';
        });
        
        // í•˜ìœ„ í˜ì´ì§€ ì œëª© ëª©ë¡ (ë””ë²„ê¹…ìš©)
        const childTitles = childItems
          .map(item => item.textContent.trim())
          .filter(text => text.length > 0)
          .slice(0, 10);
        
        return {
          success: hasTargetPage,
          hasTargetPage: hasTargetPage,
          childCount: childItems.length,
          childTitles: childTitles,
          message: hasTargetPage 
            ? "âœ… ë¶€ëª¨ í˜ì´ì§€ í•˜ìœ„ì— ìƒì„± í™•ì¸ë¨" 
            : "âŒ ë¶€ëª¨ í˜ì´ì§€ í•˜ìœ„ì— ìƒì„±ë˜ì§€ ì•ŠìŒ"
        };
      }, title);
    }`
  });
  
  return result;
}
```

### ì‚¬ìš© ì˜ˆì‹œ

```javascript
// APIë¡œ í˜ì´ì§€ ìƒì„± í›„ ê²€ì¦
try {
  // 1. APIë¡œ í˜ì´ì§€ ìƒì„±
  const createResult = await notion_create_pages({
    pages: [{ title: pageTitle, content: "" }]
  });
  
  // 2. ë¶€ëª¨ë¡œ ì´ë™ ì‹œë„
  if (parentPageId) {
    await notion_move_pages({
      pageIds: [createResult.pages[0].id],
      parentId: parentPageId
    });
  }
  
  // 3. âœ… ì‹¤ì œ ìœ„ì¹˜ ê²€ì¦ (ì‹ ê·œ ì¶”ê°€)
  const verification = await verifyPageUnderParent(
    parentPageUrl,
    pageTitle
  );
  
  // 4. ê²€ì¦ ì„±ê³µ ì‹œ ë‚´ìš© ì—…ë¡œë“œ
  if (verification.success && verification.hasTargetPage) {
    await uploadContent(createResult.pages[0].url);
  }
  
} catch (error) {
  // 5. ê²€ì¦ ì‹¤íŒ¨ ì‹œ ìë™ fallback
  console.log("âš ï¸ API ê²€ì¦ ì‹¤íŒ¨ - ë¸Œë¼ìš°ì € ìë™í™”ë¡œ ì „í™˜");
  await fallbackToBrowserAutomation(parentPageUrl, pageTitle, fileContent);
}
```

---

## ğŸ“ íŒŒì¼ ê²½ë¡œ í•´ì„ í•¨ìˆ˜

**Input**: íŒŒì¼ ê²½ë¡œ (string)  
**Output**: í•´ì„ëœ íŒŒì¼ ê²½ë¡œ (string)

**ì²˜ë¦¬ ìš°ì„ ìˆœìœ„**:

1. ì ˆëŒ€ ê²½ë¡œ (ê·¸ëŒ€ë¡œ ì‚¬ìš©)
2. ìƒëŒ€ ê²½ë¡œ (ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ë£¨íŠ¸ ê¸°ì¤€)
3. íŒŒì¼ëª…ë§Œ (ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì „ì²´ ê²€ìƒ‰ í•„ìš”)

### JavaScript ë²„ì „

```javascript
function resolveFilePath(inputPath, workspaceRoot) {
  // 1. ì ˆëŒ€ ê²½ë¡œì¸ì§€ í™•ì¸
  if (inputPath.startsWith("/") || inputPath.match(/^[A-Za-z]:/)) {
    return inputPath; // Windows: C:\..., Unix: /...
  }

  // 2. ìƒëŒ€ ê²½ë¡œ ì²˜ë¦¬
  if (inputPath.startsWith("./") || inputPath.includes("/")) {
    // ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ë£¨íŠ¸ ê¸°ì¤€ìœ¼ë¡œ í•´ì„
    return workspaceRoot + "/" + inputPath.replace(/^\.\//, "");
  }

  // 3. íŒŒì¼ëª…ë§Œ (ê²€ìƒ‰ í•„ìš”)
  return inputPath; // glob_file_searchë¡œ ê²€ìƒ‰ í•„ìš”
}
```

---

## ğŸ›¡ï¸ ê¸°ì¡´ ë‚´ìš© í™•ì¸ í•¨ìˆ˜

**ëª©ì **: ê¸°ì¡´ í˜ì´ì§€ì˜ ë‚´ìš©ì„ ë³´ì¡´í•˜ê¸° ìœ„í•œ ì•ˆì „ì¥ì¹˜

**ë¸Œë¼ìš°ì € ë„êµ¬**: `browser_evaluate`

### ì œëª© ì˜ì—­ ê¸°ì¡´ ë‚´ìš© í™•ì¸

```javascript
// browser_evaluateì—ì„œ ì‚¬ìš©
() => {
  const titleElement =
    document.querySelector('h1[contenteditable="true"]') ||
    document.querySelector('[contenteditable="true"]');

  if (!titleElement) {
    return { success: false, error: "ì œëª© ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤" };
  }

  const existingTitle = titleElement.innerText.trim();

  // ê¸°ì¡´ ì œëª©ì´ ìˆê³  "ìƒˆ í˜ì´ì§€" ë˜ëŠ” "Untitled"ê°€ ì•„ë‹ˆë©´ ë³´ì¡´
  if (
    existingTitle &&
    existingTitle !== "ìƒˆ í˜ì´ì§€" &&
    existingTitle !== "Untitled" &&
    existingTitle !== ""
  ) {
    return {
      success: true,
      preserve: true,
      existingTitle: existingTitle,
      message: `ê¸°ì¡´ ì œëª©ì´ ìˆìŠµë‹ˆë‹¤: "${existingTitle}". ê¸°ì¡´ ì œëª©ì„ ìœ ì§€í•©ë‹ˆë‹¤.`,
    };
  }

  return {
    success: true,
    preserve: false,
    message: "ìƒˆ í˜ì´ì§€ì…ë‹ˆë‹¤. ì œëª© ì…ë ¥ì„ ì§„í–‰í•©ë‹ˆë‹¤.",
  };
};
```

### ë³¸ë¬¸ ì˜ì—­ ê¸°ì¡´ ë‚´ìš© í™•ì¸

```javascript
// browser_evaluateì—ì„œ ì‚¬ìš©
() => {
  const bodyElements = document.querySelectorAll('[contenteditable="true"]');
  let existingContent = "";
  let contentBlocks = 0;

  // ì œëª©ì´ ì•„ë‹Œ ë³¸ë¬¸ ì˜ì—­ ì°¾ê¸°
  for (let elem of bodyElements) {
    if (elem.tagName !== "H1" && elem.innerText.trim() !== "") {
      existingContent += elem.innerText.trim() + " ";
      contentBlocks++;
    }
  }

  if (existingContent.trim().length > 0) {
    return {
      success: true,
      hasExistingContent: true,
      contentLength: existingContent.trim().length,
      contentBlocks: contentBlocks,
      message:
        "ê¸°ì¡´ ë‚´ìš©ì´ ìˆìŠµë‹ˆë‹¤. ê¸°ì¡´ ë‚´ìš©ì„ ë³´ì¡´í•˜ê³  í•˜ë‹¨ì—ë§Œ ì¶”ê°€í•©ë‹ˆë‹¤.",
    };
  }

  return {
    success: true,
    hasExistingContent: false,
    message: "ìƒˆ í˜ì´ì§€ì…ë‹ˆë‹¤. ë‚´ìš© ì—…ë¡œë“œë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.",
  };
};
```

---

## ğŸ“š ì°¸ì¡°

- **ë©”ì¸ ê°€ì´ë“œ**: `00_ë©”ì¸_ê°€ì´ë“œ.md`
- **ì‹¤í–‰ ê°€ì´ë“œ**: `01_ì‹¤í–‰_ê°€ì´ë“œ.md`
- **ì—ëŸ¬ ì²˜ë¦¬**: `03_ì—ëŸ¬_ì²˜ë¦¬.md`
- **í…œí”Œë¦¿**: `04_í…œí”Œë¦¿.md`

---

**Made with â¤ï¸ for AI Agents (Universal)**

---

## ğŸ“ ì¶œì²˜

**ì‘ì„±ì**: ê¹€ì¤€ëª¨  
**ì´ë©”ì¼**: rnsdlsdmtlk@gmail.com  
**ë²„ì „**: 2.0.0 (Universal)
