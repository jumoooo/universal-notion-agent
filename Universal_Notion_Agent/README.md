# 🌐 Universal Notion Agent

> AI Agent를 활용한 마크다운 파일 자동 Notion 업로드

**지원 플랫폼**: Cursor Pro, Claude CLI (claude-code), Antigravity

---

## 🎯 주요 기능

- ✅ **마크다운 → Notion 페이지 자동 변환**
- ✅ **대용량 파일 청크 분할 업로드**
- ✅ **부모 페이지 지정 지원**
- ✅ **자동 내용 검증**
- ✅ **기존 내용 보존 규칙**

---

## 🚀 사용 방법

### 0단계: Chrome 자동 로그인 설정 (권장) ⭐

**빠른 설정 (5분)**:

→ `Quick_Fix_Chrome_Profile.md` 참조

**효과**:
- ✅ Notion 자동 로그인
- ✅ Google OAuth 차단 우회
- ✅ 매번 로그인 불필요

### 1단계: MCP 서버 설정

**플랫폼별 설정 가이드 참조**:

- Cursor Pro: `Platform_Guides/Cursor/Cursor_설정_가이드.md`
- Claude CLI: `Platform_Guides/Claude/Claude_설정_가이드.md`
- Antigravity: `Platform_Guides/Antigravity/Antigravity_설정_가이드.md`

### 2단계: Agent 시작 (가이드 강제 준수 모드)

**시작 명령어**:
```
@Universal_Notion_Agent/ 시작
```

**효과**:
- 모든 Core_Guides 자동 읽기 및 강제 준수
- 검증 단계 절대 생략 불가
- 에러 처리 완벽 준수

### 3단계: 작업 실행

```
document.md 파일을 Notion에 업로드해줘
```

### 4단계: 작업 종료 (선택)

**종료 명령어**:
```
@Universal_Notion_Agent/ 종료
```

**효과**:
- 가이드 준수 모드 해제
- 일반 AI Assistant 모드로 복귀

---

## 📁 가이드 구조

### Agent_실행_가이드.md (AI Agent 동작 정의)

**AI Agent가 사용자와 상호작용하는 방법을 정의**:

- "@Universal_Notion_Agent/ 시작" 명령 처리
- 셋업 확인 및 안내 프로세스
- 진행 중 보고 형식
- 완료 보고 템플릿

### Core_Guides/ (핵심 실행 로직)

| 파일                              | 설명                           | AI 참조 시점              |
| --------------------------------- | ------------------------------ | ------------------------- |
| `00_메인_가이드.md`               | 전체 흐름 및 아키텍처          | 항상 필수                 |
| `01_실행_가이드.md`               | 단계별 실행 절차               | 구체적인 실행 방법        |
| `02_코드_패턴.md`                 | 코드 패턴 및 함수              | 코드 구현 시              |
| `03_에러_처리.md`                 | 에러 대응 절차                 | 에러 발생 시              |
| `04_템플릿.md`                    | 보고 형식 템플릿               | 사용자 소통 시            |
| `05_브라우저_프로필_설정.md`      | Chrome 프로필 설정             | Google OAuth 에러 시      |
| `06_중요_주의사항.md`             | 자주 발생하는 실수             | 항상 필수                 |
| `07_브라우저_자동화_함정.md` ⭐   | 실전 검증된 해결책             | 브라우저 자동화 사용 시   |

### Platform_Guides/ (플랫폼별 설정)

- `Cursor/Cursor_설정_가이드.md`
- `Claude/Claude_설정_가이드.md`
- `Antigravity/Antigravity_설정_가이드.md`

### Examples/ (사용 예시)

- `기본_업로드_예시.md`
- `부모_페이지_지정_예시.md`

### Templates/ (프롬프트 템플릿)

- `사용자_프롬프트_템플릿.md`

---

## 🔧 문제 해결

### Google OAuth 로그인 에러

**빠른 해결**: `Quick_Fix_Google_OAuth.md` 참조

**자세한 가이드**: `Core_Guides/05_브라우저_프로필_설정.md` 참조

---

## 📋 핵심 규칙

1. **⚠️ 공유 페이지 편집 권한 확인 필수**:
   - 부모 페이지 접속 시 반드시 편집 권한 확인
   - 권한 없으면 ERR_BROWSER_NO_EDIT_PERMISSION 에러 보고
   - 사용자에게 권한 요청 또는 다른 방법 제시

2. **🚨 페이지 생성 검증 필수**:
   - 페이지 생성 후 **반드시 실제로 생성되었는지 확인**
   - 실패 신호: `/page` 텍스트 남아있음, 제목 영역 없음, URL 미변경
   - 생성 안 되면 ERR_PAGE_CREATION_FAILED 에러 보고
   - **생성 확인 없이 다음 단계로 진행 절대 금지**

3. **✅ 제목 입력 검증 필수** (품질 보장):
   - 제목 입력 후 **반드시 정확히 입력되었는지 확인**
   - 제목이 잘못되면 즉시 수정
   - 제목에 명령어(`/page`, `Ctrl+Shift+P` 등) 포함 금지
   - **검증 없이 다음 단계로 진행 금지**

4. **✅ 내용 영역 이동 확인 필수** (품질 보장):
   - 내용 입력 전 **반드시 제목 영역에서 벗어났는지 확인**
   - 제목 영역과 내용 영역 명확히 분리
   - 내용 영역으로 완전히 이동한 후에만 청크 업로드 시작

5. **✅ 청크 입력 시 품질 검증 필수** (문서 품질 보장):
   - **입력 전**: 제목 영역에 있지 않은지, 제목이 변경되지 않았는지 확인
   - **입력 후 1**: 제목이 변경되지 않았는지 확인 (매 청크)
   - **입력 후 2**: 이전 청크와 연결되는지 확인 (2번째 청크부터)
   - 순서 섞임 또는 제목 변경 감지 시 즉시 중단

6. **🚨 부모 페이지 지정 시 API 실패하면 자동 fallback**: 
   - API 이동 실패 → 즉시 브라우저 자동화(PlayWright)로 전환
   - **절대 전역에 생성하고 끝내지 않음**
   - 실패를 감지하고 다른 방법으로 재시도하는 것이 핵심

7. **기존 내용 절대 삭제 금지**: 기존 Notion 페이지 내용은 절대 삭제하지 않음

8. **청크 분할 업로드**: 대용량 파일은 자동으로 청크 분할하여 안정적으로 업로드

9. **자동 내용 검증**: 업로드 완료 후 마지막 줄 텍스트를 확인하여 검증

10. **에러 즉시 보고**: 모든 에러는 즉시 사용자에게 보고하고 해결 방법 안내 (단, API 이동 실패는 자동 복구)

---

**Universal Notion Agent v2.1.3**
